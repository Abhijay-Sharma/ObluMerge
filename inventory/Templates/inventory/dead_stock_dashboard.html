<!-- dead_stock_dashboard.html
this is dashboard that display the dead stock product (not sold in long time-->

{% extends 'inventory/base.html' %}

{% block content %}

<style>

     .date-filter-form {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
          flex-wrap: wrap;
          margin: 50px auto;
        }

        .date-filter-form label {
          font-weight: 500;
        }

        .date-filter-form input[type="date"] {
          padding: 5px 10px;
          border: 1px solid #ccc;
          border-radius: 6px;
        }

        .date-filter-form .btn {
          padding: 6px 16px;
          border-radius: 6px;
        }

        .summary-card {
            flex: 0 0 85%;
            max-width: 100%;
            max-height: 100%;
            padding: 5px 2px;
            box-sizing: border-box;
            text-align: center;

          }

          .summary-card h5 {
            font-size: 1.2rem;
          }

          .summary-card h3 {
            font-size: 2rem;
          }

        @media (max-width: 768px) {
          .row.mb-4.justify-content-center {
            display: flex;
            flex-wrap: nowrap;
            align-items: centre;
            overflow-x: auto;
            padding: 0 70px;
            margin: 0;
            scroll-behavior: smooth
          }

          .summary-card {
            flex: 0 0 85%;
            max-width: 90%;
            max-height: 80%;
            padding: 5px 2px;
            box-sizing: border-box;
            text-align: center;
          }

          .summary-card h5 {
            font-size: 0.7rem;
          }

          .summary-card h3 {
            font-size: 0.8rem;
          }
        }
        /* ===== CATEGORY ACCORDION (SMOOTH + LINE BY LINE) ===== */

    .accordion {
        display: block;                 /* âœ… force new line */
        width: 100%;
        background-color: #1e1e1e;
        color: white;
        cursor: pointer;
        padding: 14px 18px;
        margin-top: 12px;
        border: none;
        text-align: left;
        outline: none;
        font-size: 16px;
        border-radius: 10px;
        transition: background 0.3s ease;
    }

    .accordion:hover,
    .accordion.active {
        background-color: #333;
    }

    /* Panel container */
    .panel {
        width: 100%;
        overflow: hidden;
        max-height: 0;                  /* âœ… collapsed by default */
        transition: max-height 0.45s ease, padding 0.3s ease;
        background-color: #2c2c2c;
        border-radius: 10px;
        margin-bottom: 12px;
        padding: 0 16px;                /* no vertical padding when closed */
    }


        /* Open state */
        .panel.open {
            padding: 12px 16px;
        }


        @media (max-width: 420px) {
          .row.mb-4.justify-content-center {
            display: flex;
            flex-wrap: nowrap;
            justify-content: flex-start;
            align-items: stretch;
            overflow-x: auto;
            gap: 4px;
            padding: 0 70px;
            margin-left: 0 !important;
            margin-right: 0 !important;
            scroll-behavior: smooth;
          }

          .summary-card {
            max-width: 100%;
            text-align: center;
          }

          .summary-card h5 {
            font-size: 0.7rem;
          }

          .summary-card h3 {
            font-size: 1.2rem;
          }
        }

        @media (max-width: 360px) {

          h2{
            font-size: 1rem;
          }
          .row.mb-4.justify-content-center {

            align-items: center;
            justify-content: center;
            gap: 8px;
            overflow-x: hidden;
            padding: 0;
            margin: 0;
          }

          .summary-card {
            max-width: 100%;
            text-align: center;
          }

          .summary-card h5 {
            font-size: 0.85rem;
          }

          .summary-card h3 {
            font-size: 1rem;
          }
        }


</style>


<div class="container mt-4">
  <h2 style="color:white;">ðŸ§Š Dead Stock â€“ Category Wise</h2>

<form method="get" class="date-filter-form">
  <label>From:</label>
  <input type="date" name="from" value="{{ from_date|date:'Y-m-d' }}">
  <label>To:</label>
  <input type="date" name="to" value="{{ to_date|date:'Y-m-d' }}">
  <button class="btn btn-primary">Apply</button>
</form>

{% for category, items in category_data.items %}
  <button class="accordion">{{ category }}</button>

  <div class="panel">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Quantity</th>
          <th>Last Sold</th>
          <th>Last Customer</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr>
            <td>{{ item.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>
              {% if item.last_sold %}
                {{ item.last_sold }}
              {% else %}
                <i>Never Sold</i>
              {% endif %}
            </td>
            <td>
              {% if item.customer_link %}
                <a href="{{ item.customer_link }}">{{ item.last_customer }}</a>
              {% else %}
                -
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% empty %}
  <p class="text-center text-muted">âœ… No Dead Stock Found</p>
{% endfor %}

</div>

<script>
  const accordions = document.querySelectorAll(".accordion");

  accordions.forEach(acc => {
    acc.addEventListener("click", function () {
      this.classList.toggle("active");

      const panel = this.nextElementSibling;

      if (panel.style.maxHeight) {
        panel.style.maxHeight = null;
        panel.classList.remove("open");
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
        panel.classList.add("open");
      }
    });
  });
</script>


{% endblock %}
