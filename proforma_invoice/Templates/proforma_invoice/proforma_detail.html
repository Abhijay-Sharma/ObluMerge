{% load static %}
<html lang="en">
<head>

<link rel="stylesheet"
 href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<meta charset="UTF-8">
<title>Proforma Invoice</title>

<style>
@page { size:A4 portrait; margin:14mm; }

body{
  font-family: Arial, Helvetica, sans-serif;
  font-size:12px;
  color:#000;
  margin:0;
}

.wrapper{ width:100%; }
.invoice-container{ padding:10px 14px; }

/* ================= GLOBAL ================= */
table{ width:100%; border-collapse:collapse; }
td, th{ padding:6px; vertical-align:top; }

.bold{ font-weight:bold; }
.center{ text-align:center; }
.right{ text-align:right; }

/* ================= HEADER ================= */
.header-top{
  display:grid;
  grid-template-columns:120px 1fr auto;
  column-gap:14px;
}

.company-info{ line-height:1.4; }

.logo{
  width:120px;
  height:100px;
  object-fit:contain;
}

hr{
  border:none;
  border-top:2px solid #0b78a8;
  margin:10px 0 14px;
}

.header-title{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  color:#0b78a8;
  margin-bottom:14px;
}

/* ================= INFO GRID ================= */
.info-grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:30px;
  margin-bottom:18px;
}
.info-grid b{ display:block; margin-bottom:6px; }

/* ================= ITEM TABLE ================= */
.item-table{
  border:2px solid #000;
}

.item-table th,
.item-table td{
  border-left:1px solid #000;
}

.item-table thead th{
  background:#0b78a8;
  color:#fff;
  text-align:center;
  border-bottom:2px solid #000;
}

.item-table tbody td{
  border-bottom:1px solid #999;
}

.item-table tbody tr:last-child td{
  border-bottom:none;
}

.item-name{
  text-align:left;
  padding-left:12px;
}

/* ================= TOTALS ================= */
.totals-wrapper table{
  margin-top:-3px;
  border-bottom:2px solid #000;
}

.totals-wrapper td{
  border-bottom:1px solid #999;
}

.totals-wrapper td:last-child{
  border-left:2px solid #000;
  border-right:2px solid #000;
  text-align:right;
  width:123px;
}

.totals-wrapper tr:last-child td{
  border-bottom:none;
  font-weight:bold;
}

.totals-highlight{
  background:#0b78a8;
  color:#fff;
}

/* ================= QR ================= */
.qr-box{
  display:flex;
  justify-content:flex-end;
}

.qr-row{
  display:flex;
  gap:10px;
}

.qr-item{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  width:110px;
}

.qr-img{
  width:90px;
  height:90px;
  object-fit:contain;
}

.qr-text{
  font-size:10px;
  font-weight:bold;
  color:#0b78a8;
  display:flex;
  align-items:center;
  gap:6px;
}

/* ================= PRINT ================= */
@media print{

  *{
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  body{ font-size:11px; color:#000 !important; }
  .logo{ width:90px; height:60px; }
  .no-print{ display:none; }

  .item-table th,
  .item-table td{
    padding:4px;
    font-size:11px;
    color:#000 !important;
  }

  /* HEADER BLUE IN PRINT */
  .item-table thead th{
    background:#0b78a8 !important;
    color:#fff !important;
  }

  /* TOTAL ROW BLUE IN PRINT */
  .totals-highlight td{
    background:#0b78a8 !important;
    color:#fff !important;
  }

  .totals-wrapper td:last-child{
    width:160px;
  }

  /* QR print layout */
  .qr-row{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:6px 10px;
    justify-items:center;
  }

  .qr-item.yt{
    grid-column:1 / -1;
  }

  .qr-img{
    width:85px;
    height:85px;
  }

  .qr-text{
    font-size:9px;
  }
}

.footer-text{
  text-align:center;
  font-size:11px;
  margin-top:30px;
}
</style>
</head>

<body>
<div class="invoice-container">
<div class="wrapper">

<!-- HEADER -->
<div class="header-top">

<img src="https://oblu-static-media.s3.ap-south-1.amazonaws.com/vector_panda_logo.png"
     class="logo">

<div class="company-info">
<b>OBLU HEALTHCARE LLP</b><br>
UNIT NO.705-706 PLOT NO.3, P P CITY CENTRE,<br>
ROAD NO.44, Pitampura, New Delhi – 110034<br>
Phone : 96504 47099<br>
Email : sales@obluhc.com<br>
GSTIN : 07AAIFO0279M1ZU<br>
PAN : AAIFO0279M<br>
State : 07-Delhi
</div>

<div class="qr-box">
  <div class="qr-row">

    <div class="qr-item ig">
      <img src="https://oblu-static-media.s3.ap-south-1.amazonaws.com/insta_qr.png"
           class="qr-img">
      <div class="qr-text">
        <i class="fa-brands fa-instagram"></i>
        OBLU_HEALTHCARE
      </div>
    </div>

    <div class="qr-item fb">
      <img src="https://oblu-static-media.s3.ap-south-1.amazonaws.com/fb_profile_qr.png"
           class="qr-img">
      <div class="qr-text">
        <i class="fa-brands fa-facebook" style="color:#4670b9;"></i>
        Oblu Healthcare
      </div>
    </div>

    <div class="qr-item yt">
      <img src="https://oblu-static-media.s3.ap-south-1.amazonaws.com/youtube_profile_qr.png"
           class="qr-img">
      <div class="qr-text">
        <i class="fa-brands fa-youtube" style="color:#c41717;"></i>
        Oblu Healthcare
      </div>
    </div>

  </div>
</div>

</div>

<hr>
<div class="header-title">Proforma Invoice</div>

<!-- ================= INFO ================= -->
<div class="info-grid">

  <div>
    <b>Order From
    {{ invoice.customer.name }}<br>
    {{ invoice.customer.address }}<br>
    {{ invoice.customer.city }} - {{ invoice.customer.pincode }}<br>
    {{ invoice.customer.state }}<br>
    Contact : {{ invoice.customer.phone }} </b>
  </div>

  <div>
    <b>Ship To
    {{ invoice.customer.name }}<br>
    {{ invoice.customer.address }}<br>
    {{ invoice.customer.city }} - {{ invoice.customer.pincode }}<br>
    {{ invoice.customer.state }}<br>
    Mob : {{ invoice.customer.phone }}</b>
  </div>

  <div>
    <b>Order Details
    Order No. : {{ invoice.id }}<br>
    Date : {{ invoice.date_created|date:"d-m-Y" }}<br>
    Place of Supply : Delhi</b>
  </div>

</div>

<!-- ================= ITEM TABLE ================= -->
<table class="item-table">
<thead>
<tr>
  <th>#</th>
  <th class="item-name">Item name</th>
  <th>HSN</th>
  <th>Qty</th>
  <th class="right">Rate<br>(Inc.)</th>
  <th class="right">Rate<br>(Exc.)</th>
  <th class="right">Taxable <br> Value</th>
  <th class="center">GST%</th>
  <th class="right">Amount</th>
</tr>
  <hr>
</thead>

<tbody>
{% for item in items %}
{% widthratio item.total_price 100 item.taxrate as item_gst %}
{% widthratio item.unit_price 100 item.taxrate as unit_gst %}
{% with item.unit_price|add:unit_gst as rate_incl_tax %}
<tr>
  <td class="center">{{ forloop.counter }}</td>
  <td class="item-name">{{ item.product.name }}</td>
  <td class="center">{{ item.hsn }}</td>
  <td class="center">{{ item.quantity }}</td>
  <td class="right">₹ {{ item.unit_price|floatformat:2 }}</td>
  <td class="right">₹ {{ item.unit_price_excl_tax|floatformat:2 }}</td>
  <td class="right">₹ {{ item.total_price_excl_tax|floatformat:2 }}</td>
  <td class="center">{{ item.taxrate }}%</td>
  <td class="right">₹ {{ item.total_price|floatformat:2 }}</td>

</tr>
{% endwith %}
{% endfor %}
</tbody>
</table>



<div class="totals-wrapper">
<table>
<tr>
<!--  <td width="60%" style="font-size:13px;">-->
<!--    <b >Order Amount In Words</b><br>-->
<!--    INR {{  invoice.grand_total_in_words }}-->
<!--  </td>-->

  <td width="40%">
    <table>
      <tr>
        <td class="right bold" style="font-size:13px;">Sub Total</td>
        <td class="right" style="font-size:13px; border-right:none;">₹ {{ invoice.taxable_total|floatformat:2 }}</td>
      </tr>
      <tr>
        <td class="right bold" style="font-size:13px;">Courier Charges</td>
        <td class="right" style="font-size:13px; border-right:none;">₹ {{ invoice.courier_charge|floatformat:2 }}</td>
      </tr>
      <tr>
        <td class="right bold" style="font-size:13px;">IGST @ {{ gst_rate }}%</td>
          <td class="right" style="font-size:13px; border-right:none;">
          ₹ {{ invoice.igst_total |floatformat:2 }}
        </td>

      </tr>
      <tr class="totals-highlight">
        <td class="right">Total</td>
        <td class="right" style="font-size:13px; border-right:none;">₹ {{ invoice.grand_total|floatformat:2 }}</td>
      </tr>
    </table>
  </td>
</tr>
</table>
</div>


<!-- ================= BANK ================= -->
<div style="margin-top:18px;">
  <b>Company's Bank Details:<br><br>
  A/c Holder : OBLU HEALTHCARE LLP<br><br>
  Bank : ICICI BANK (CC)<br><br>
  A/c No. : 629351001224<br><br>
  Branch & IFSC : Rajouri Garden & ICIC0006293</b>
</div>

<div style="text-align:right; margin-top:20px;">
  For OBLU HEALTHCARE LLP<br><br>
  <img src="{{ signature_base64 }}"
       style="width:140px; height:auto;" alt="Signature"><br>
  <b>Authorized Signatory</b>
</div>

<div class="footer-text">
  This is a computer generated invoice
</div>

<div class="no-print" style="text-align:center;margin-top:14px;">
  <button onclick="window.print()"
    style="padding:8px 16px;background:#333;color:#fff;border:none;cursor:pointer;">
    Print / Save as PDF
  </button>
</div>

</div>
</div>
</body>
</html>