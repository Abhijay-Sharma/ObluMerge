{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Proforma Invoice</title>

<style>
@page { size: A4 portrait; margin: 14mm; }

body{
  font-family: Arial, Helvetica, sans-serif;
  font-size: 12px;
  color:#000;
  margin:0;
}

.wrapper{ width:100%; }
.invoice-container{ padding:10px 14px; }

/* GLOBAL */
table{ width:100%; border-collapse:collapse; }
td, th{ border:none; padding:6px; vertical-align:top; }

.bold{ font-weight:bold; }
.center{ text-align:center; }
.right{ text-align:right; }

/* HEADER */
.header-top{
  display:flex;
  justify-content:space-between;
}

.company-info{ width:65%; line-height:1.4; }
.logo{ width:140px; }

hr{
  border:none;
  border-top:2px solid #0b78a8;
  margin:10px 0 14px;
}

.header-title{
  text-align:center;
  font-size:18px;
  font-weight:bold;
  color:#0b78a8;
  margin-bottom:14px;
}

/* INFO GRID */
.info-grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:30px;
  margin-bottom:18px;
}
.info-grid b{ display:block; margin-bottom:6px; }

/* ITEM TABLE */
.item-table thead th{
  background:#0b78a8;
  color:#fff;
  font-weight:bold;
  text-align:center;
}

.item-table th.right,
.item-table td.right{ text-align:right; padding-right:12px; }

.item-table th.center,
.item-table td.center{ text-align:center; }

.item-table tbody td{ border-bottom:1px solid #999; }

.item-name{ text-align:left; padding-left:14px; }

/* TOTALS */
.totals-wrapper{ margin-top:16px; }

.totals-highlight{
  background:#0b78a8;
  color:#fff;
  font-weight:bold;
}

/* FOOTER */
.footer-text{
  text-align:center;
  font-size:11px;
  margin-top:30px;
}

@media print{ .no-print{ display:none; } }
</style>
</head>

<body>
<div class="invoice-container">
<div class="wrapper">

<!-- HEADER -->
<div class="header-top">
  <div class="company-info">
    <b>OBLU HEALTHCARE LLP</b><br>
    <b>UNIT NO.705-706 PLOT NO.3, P P CITY CENTRE,</b><br>
    <b>ROAD NO.44, Pitampura, New Delhi – 110034</b><br>
    <b>Phone :</b> 96504 47099<br>
    <b>Email :</b> sales@obluhc.com<br>
    <b>GSTIN :</b> 07AAIFO0279M1ZU<br>
    <b>PAN :</b> AAIFO0279M<br>
    <b>State :</b> 07-Delhi
  </div>

  <img src="https://obluhc.com/cdn/shop/files/Oblu_Logo_black_2025_0_size.webp?v=1757743482"
       class="logo" alt="OBLU Logo">
</div>

<hr>

<div class="header-title">Proforma Invoice</div>

<!-- INFO GRID -->
<div class="info-grid">

  <div>
    <b>Order From</b>
    {{ invoice.customer.name }}<br>
    {{ invoice.customer.address }}<br>
    {{ invoice.customer.city }} - {{ invoice.customer.pincode }}<br>
    {{ invoice.customer.state }}<br>
    Contact No. : {{ invoice.customer.phone }}
  </div>

  <div>
    <b>Ship To</b>
    {{ invoice.customer.name }}<br>
    {{ invoice.customer.address }}<br>
    {{ invoice.customer.city }} - {{ invoice.customer.pincode }}<br>
    {{ invoice.customer.state }}<br>
    Mob : {{ invoice.customer.phone }}
  </div>

  <div>
    <b>Order Details</b>
    Order No. : {{ invoice.id }}<br>
    Date : {{ invoice.date_created|date:"d-m-Y" }}<br>
    Place of Supply : Delhi
  </div>

</div>

<!-- ITEM TABLE -->
<table class="item-table">
<thead>
<tr>
  <th>#</th>
  <th class="item-name">Item name</th>
  <th>HSN</th>
  <th>Qty</th>
  <th class="right">Rate (Excl. Tax)</th>
  <th class="right">Rate (Incl. Tax)</th>
  <th class="right">Taxable Value</th>
  <th class="center">GST</th>
  <th class="right">Amount</th>
</tr>
</thead>

<tbody>
{% for item in items %}
{% widthratio item.total_price 100 item.taxrate as item_gst %}
{% widthratio item.unit_price 100 item.taxrate as unit_gst %}
{% with item.unit_price|add:unit_gst as rate_incl_tax %}
<tr>
  <td class="center">{{ forloop.counter }}</td>
  <td class="item-name">{{ item.product.name }}</td>
  <td class="center">{{ item.hsn }}</td>
  <td class="center">{{ item.quantity }}</td>
  <td class="right">₹ {{ item.unit_price|floatformat:2 }}</td>
  <td class="right">₹ {{ rate_incl_tax|floatformat:2 }}</td>
  <td class="right">₹ {{ item.total_price|floatformat:2 }}</td>
  <td class="center">{{ item.taxrate }}%</td>
  <td class="right">₹ {{ item.total_price|floatformat:2 }}</td>
</tr>
{% endwith %}
{% endfor %}
</tbody>
</table>

<!-- TOTALS -->
{% with items.0.taxrate as gst_rate %}
{% widthratio invoice.items_total 100 gst_rate as igst_value %}
{% with invoice.courier_charge|default:0 as courier_charge %}
{% with invoice.courier_gst|default:0 as courier_gst %}
{% with invoice.items_total|add:igst_value|add:courier_charge|add:courier_gst as display_total %}

<div class="totals-wrapper">
<table>
<tr>
  <td width="60%">
    <b>Order Amount In Words</b><br>
    INR {{ display_total|floatformat:0 }} Only
  </td>

  <td width="40%">
    <table>
      <tr>
        <td class="right">Sub Total</td>
        <td class="right">₹ {{ invoice.items_total|floatformat:2 }}</td>
      </tr>
      <tr>
        <td class="right">IGST @ {{ gst_rate }}%</td>
        <td class="right">₹ {{ igst_value|floatformat:2 }}</td>
      </tr>
      <tr>
        <td class="right">Courier Charges</td>
        <td class="right">₹ {{ courier_charge|floatformat:2 }}</td>
      </tr>
      <tr>
        <td class="right">Courier GST</td>
        <td class="right">₹ {{ courier_gst|floatformat:2 }}</td>
      </tr>
      <tr class="totals-highlight">
        <td class="right bold">Total</td>
        <td class="right bold">₹ {{ display_total|floatformat:2 }}</td>
      </tr>
    </table>
  </td>
</tr>
</table>
</div>

{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}

<!-- PAY TO -->
<div class="pay-grid">
  <div>
    <b>Company's Bank Details</b><br>
    <b>A/c Holder's Name :</b> OBLU HEALTHCARE LLP<br>
    <b>Bank Name :</b> ICICI BANK (CC)<br>
    <b>A/c No. :</b> 629351001224<br>
    <b>Branch & IFS Code :</b> Rajouri Garden & ICIC0006293
  </div>

  <div class="signature">
    For OBLU HEALTHCARE LLP<br><br>
    <b>Authorized Signatory</b>
  </div>
</div>

<div class="footer-text">
  This is a computer generated invoice
</div>

<div class="no-print" style="text-align:center;margin-top:12px;">
  <button onclick="window.print()"
    style="padding:8px 16px;background:#333;color:#fff;border:none;cursor:pointer;">
    Print / Save as PDF
  </button>
</div>

</div>
</div>
</body>
</html>
