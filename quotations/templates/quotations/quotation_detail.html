{% load static %}

<html>
<head>
    <meta charset="UTF-8">
    <title>Quotation</title>
    <style>
        body {
            font-family: DejaVu Sans, sans-serif;
            padding: 40px;
            color: #333;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }


        .header img {
            height: 70px;
        }

        .contact-info {
            text-align: right;
            font-size: 15px;
        }

        .contact-info div {
            margin-bottom: 5px;
        }

        .quotation-info, .customer-info {
            margin-bottom: 20px;
            font-size: 14px;
        }

        .customer-info p, .quotation-info p {
            margin: 4px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px;
        }

        th {
            background-color: #f4f4f4;
        }
        td{
            text-align: center;
        }

        .total {
            text-align: right;
            margin-top: 20px;
            font-size: 15px;
        }

       .terms {
            margin-top: 20px;
        }

        .terms h3 {
            text-decoration: underline;
            font-weight: bold;
        }

        .terms ol {
            margin-left: 20px;
            font-size: 12px;
        }

        .bank-details {
            margin-left: 30px;
        }

        .signature {
            margin-top: 40px;
            margin-left: 60px;
            font-size: 14px;
            text-align: center;
        }

        .signature img {
            height: 100px;
            margin-top: 2px;
        }

        .contact-info2 {
            margin-top: 10px;
            height: 30px;
            background-color: rgb(32, 31, 31);
            display: flex;
            justify-content: space-around;
            align-items: center;
            color: white;
            font-size: 14px;
        }
            @media print {
        .contact-info2 {
            margin-top: 10px;
            height: 30px;
            background-color: #333 !important;
            display: flex !important;
            justify-content: space-around;
            align-items: center;
            color: white !important;
            font-size: 14px;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
        .page-break {
            page-break-before: always;
            break-before: page;
        }


    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</head>
<body>
     <div class="contact-info2">
        <span>QUOTATION</span>
    </div>
    <div class="header">
        <img src="https://obluhc.com/cdn/shop/files/Oblu_Logo_black_2025_0_size.png?v=1747391104" alt="OBLU Logo">
        <div class="contact-info">
            <div><b>A:</b> 705-706, 7th Floor, PP City Centre,<br> Pitampura, New Delhi - 110034</div>
            <div><b>GST No.:</b> 07AAIFO0279M1ZU</div>
            <div><b>LLPIN:</b> ABB-5224</div>
        </div>
    </div>

    <div class="contact-info2">
        <span> M:+91 96504 47099</span>
        <span> E:sales@obluhc.com</span>
        <span>W:www.obluhc.com</span>
    </div>

    <div class="customer-info">
        <p><strong>To:</strong> {{ quotation.customer_name }}</p>
        <p><strong>Address:</strong> {{ quotation.customer_address }}</p>
        {% if quotation.customer_state %}
            <p><strong>State:</strong> {{ quotation.customer_state }}</p>
        {% endif %}
        {% if quotation.customer_city %}
            <p><strong>City:</strong> {{ quotation.customer_city }}</p>
        {% endif %}
        {% if quotation.customer_pincode %}
            <p><strong>Pincode:</strong> {{ quotation.customer_pincode }}</p>
        {% endif %}
        {% if quotation.customer_phone %}
            <p><strong>Phone Number:</strong> {{ quotation.customer_phone }}</p>
        {% endif %}
        {% if quotation.customer_email %}
            <p><strong>Email:</strong> {{ quotation.customer_email }}</p>
        {% endif %}
        {% if quotation.customer_company %}
            <p><strong>Company:</strong> {{ quotation.customer_company }}</p>
        {% endif %}
    </div>

    <div class="quotation-info">
        <p><strong>Quotation Ref. No.:</strong> OBLU/2025-26/{{ quotation.id|stringformat:"03d" }}</p>
        <p><strong>Created By:</strong> {{ quotation.created_by }}</p>
        <p><strong>Date:</strong> {{ quotation.date_created|date:"d.m.Y" }}</p>
        <p><strong>Validity:</strong> {{ quotation.validity|date:"d.m.Y" }}</p>
    </div>

    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>Product</th>
                <th>Qty</th>
                <th>Net Price (₹)</th>
                <th>GST (%)</th>
                <th>GST Amount</th>
                <th>Unit Price (Inc. GST)</th>
                {% if has_discount %}
                    <th>Discount (₹)</th>
                {% endif %}
                <th>Total (₹)</th>
            </tr>
        </thead>
        <tbody>
            {% for item in quotation.items.all %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.product.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.unit_price_without_tax }}</td>
                <td>{{ item.product.tax_rate }}</td>
                <td>{{ item.gst_amount }}</td>
                <td>{{item.gst_unit_price}}</td>
                {% if has_discount %}
                    <td>{{ item.discount|default:"-" }}</td>
                {% endif %}
                <td>{{ item.total_price }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="total">
        <strong>Grand Total: ₹{{ quotation.total }}</strong>
    </div>

    <div class="signature">
    <p><strong>This is a system generated quotation</strong></p>
</div>

    <hr>

    <div class="page-break"></div>


    <!-- Updated Terms and Conditions -->
     <div class="contact-info2">
        <span>QUOTATION</span>
    </div>
    <div class="header">
    <img src="https://obluhc.com/cdn/shop/files/Oblu_Logo_black_2025_0_size.png?v=1747391104" alt="OBLU Logo">
    <div class="contact-info">
        <div><b>A:</b> 705-706, 7th Floor, PP City Centre,<br> Pitampura, New Delhi - 110034</div>
        <div><b>GST No.:</b> 07AAIFO0279M1ZU</div>
        <div><b>LLPIN:</b> ABB-5224</div>
    </div>
</div>
    <div class="contact-info2">
        <span> M:+91 96504 47099</span>
        <span> E:sales@obluhc.com</span>
        <span>W:www.obluhc.com</span>
    </div>

    <div class="terms">
        <h3>Terms And Conditions</h3>
        <ol>
            <li>Prices: Quoted are on F.O.R Destination and inclusive of GST.</li> <br>
            <li>
                Payment: 100% payment in advance by NEFT / RTGS / Demand Draft / Cheque in our favor, payable at New
                Delhi
                <br><br>
                <div class="bank-details">
                    <span style="text-decoration: underline;"> Our bank details are as follows:</span><br><br>
                    OBLU HEALTHCARE LLP<br>
                    AC NO- 629305041976<br>
                    IFSC CODE- ICIC0006293<br>
                    ICICI BANK LTD<br>
                    ADDRESS - J-12/18 RAJOURI GARDEN NEW DELHI 110027
                </div>
            </li> <br>
            <li>Delivery: 2-3 weeks from the date of receipt of confirmed order along with advance.</li> <br>
        {% if quotation.product_terms %}
            <li><strong>Product-specific terms:</strong>
                <ul>
                    {% for line in quotation.product_terms.splitlines %}
                        <li>{{ line }}</li>
                    {% endfor %}
                </ul>
            </li>
        {% endif %} <br>
            <li>
                Force Majeure Clause: Our offer is subject to force de majeure and we shall not be responsible for any
                breach of contract arising out of unforeseen situation viz. acts of God, Govt, fires, floods, strike,
                war, freight embargo, severe weather.
                <br><br>
                Order Cancellation fee of 25% of the Order Value will be charged, if Customer / End User cancels the
                order after confirmation.
            </li> <br>
            <li>All disputes are subject to Delhi Jurisdiction.</li>
            <!-- ✅ Product-specific terms -->

        </ol>
    </div>

    <div class="signature">
        <p><strong>This is a system generated quotation</strong></p>
    </div>

    <hr>
    <div id="download-tools">
        <button onclick="downloadPDF()" style="margin-top: 20px; padding: 10px 20px; background-color: #333; color: white; border: none; cursor: pointer;">
            Download PDF
        </button>


    </div>


<script>

    function downloadPDF() {
    // Hide buttons before print
    const tools = document.getElementById('download-tools');
    if (tools) tools.style.display = 'none';

    window.print();

    // Restore buttons after short delay
    setTimeout(() => {
        if (tools) tools.style.display = '';
    }, 1000);
    }
    function generatePDF() {
    const tools = document.getElementById('download-tools');
    if (tools) tools.style.display = 'none';

    const element = document.body;

    const opt = {
        margin:       0.5,
        filename:     'quotation.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
    };
    }
</script>


</body>
</html>
